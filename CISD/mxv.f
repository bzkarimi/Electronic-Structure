!> MXVA: matrix-vector product
!>
!> calculates the \f${\tt ncol}\times{\tt nrow}\f$ matrix product
!> \f$ \bf r = A b\f$.
!>
!> \param a real array containing the matrix \f$A\f$; note that the
!>       matrix may be supplied transposed, with non-unit stride, and with
!>       enlarged leading dimension, under the control of the parameters
!>       \c mcola, \c mrowa described below.
!> \param mcola_ increment between advacent rows of \f$A\f$ (= increment
!>        between elements in a column of \f$A\f$).
!> \param mrowa_ increment between adjacent columns of \f$A\f$ (= increment
!>        between elements in a row of \f$A\f$).
!> \param b real array containing the vector \f$b\f$.
!> \param mcolb_ increment between elements in \f$b\f$.
!> \param r real array containing the vector \f$r\f$; \c r is cleared
!>       to zero at the start of \c mxma, and so any previous contents
!>       are lost.
!> \param mcolr_ increment between elements in \f$r\f$
!> \param ncol_ number of rows on \f$A\f$ and number of elements in
!>              \f$r\f$ (= length of columns in \f$A\f$).
!> \param nlink_ number of columns in \f$A\f$ and number of elements in \f$b\f$.
!>
!> Thus standard use of \c mxva would take the form
!> \verbatim call mxva(A,1,ncol,B,1,R,1,ncol,nlink) \endverbatim

 #ifdef MOLPRO_sxf90
c--------------------------------------------------------------------
      subroutine mxva(a,mcola,mrowa,b,mcolb,
     *r,mcolr,ncol,nlink)
c... r(ncol)=a(ncol,nlink)*b(nlink) matrix mult
c     calling NEC vector routine
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      dimension r(1),a(1),b(1)
      if(ncol.eq.0) return
      if(nlink.eq.0) then
        do i=1,ncol
        r((i-1)*mcolr+1)=0.0d0
        end do
      else
        call VDMXVA(a,mcola,mrowa,b,mcolb,r,mcolr,ncol,nlink)
      end if
      return
      end
c--------------------------------------------------------------------
      subroutine mxvb(a,mcola,mrowa,b,mcolb,
     *r,mcolr,ncol,nlink)
c     inner product version for SUPER-UX, now  replaced by assembler
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      dimension r(1),a(1),b(1)
c... r(ncol,nrow)=r(ncol,nrow)+a(ncol,nlink)*b(nlink,nrow) matrix mult
      iaa=1-mrowa
      ibb=1-mcolb
      irr=1-mcolr
      do 300 i=1,ncol
      s=0
      do 100 k=1,nlink
100   s=a(iaa+k*mrowa)*b(ibb+k*mcolb)+s
      r(irr+i*mcolr)=r(irr+i*mcolr)+s
300   iaa=iaa+mcola
      return
      end
#else
!---------------------------------------------
!     Commented by me down to here
!---------------------------------------------

c--------------------------------------------------------------------
      subroutine mxva(a,mcola_,mrowa_,b,mcolb_,
     1                r,mcolr_,ncol_,nlink_)
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      integer mcola_,mrowa_,mcolb_,mcolr_,ncol_,nlink_
      !include "common/clseg"
      parameter (i16=16)
      double precision, dimension(*) :: r, a, b
c...  r(ncol)=a(ncol,nlink)*b(nlink) matrix x vector mult
      if(ncol_.eq.0) return
      ncol=ncol_
      nlink=nlink_
      mcola=mcola_
      mrowa=mrowa_
      mcolb=mcolb_
      mcolr=mcolr_
#ifdef MOLPRO_BLAS
      if(noblas.eq.0.and.ncol.ge.mindgv.and.nlink.ge.mindgv) then
        if(mcola.eq.1.and.mrowa.ge.ncol) then
          call dgemv_x('N',ncol,nlink,1.0d0,a,mrowa,b,mcolb,0.0d0,
     >                  r,mcolr)
          return
        else if(mrowa.eq.1.and.mcola.ge.ncol) then
          call dgemv_x('T',nlink,ncol,1.0d0,a,mcola,b,mcolb,0.0d0,
     >                r,mcolr)
          return
        end if
      end if
#endif
      if(mcola.ne.1) then
         call mxvax_(a,mcola,mrowa,b,mcolb,
     1               r,mcolr,ncol,nlink)
         return
      end if
      ia1=1
      ir1=1
      do 200 i=1,ncol-15,16
      iaa=ia1
      ibb=1
      s1=0.0d0
      s2=0.0d0
      s3=0.0d0
      s4=0.0d0
      s5=0.0d0
      s6=0.0d0
      s7=0.0d0
      s8=0.0d0
      s9=0.0d0
      s10=0.0d0
      s11=0.0d0
      s12=0.0d0
      s13=0.0d0
      s14=0.0d0
      s15=0.0d0
      s16=0.0d0
      do 160 k=1,nlink
      iaaa=iaa
      s1=s1+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s2=s2+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s3=s3+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s4=s4+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s5=s5+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s6=s6+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s7=s7+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s8=s8+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s9=s9+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s10=s10+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s11=s11+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s12=s12+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s13=s13+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s14=s14+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s15=s15+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s16=s16+a(iaaa)*b(ibb)
      iaa=iaa+mrowa
160   ibb=ibb+mcolb
      r(ir1)=s1
      ir1=ir1+mcolr
      r(ir1)=s2
      ir1=ir1+mcolr
      r(ir1)=s3
      ir1=ir1+mcolr
      r(ir1)=s4
      ir1=ir1+mcolr
      r(ir1)=s5
      ir1=ir1+mcolr
      r(ir1)=s6
      ir1=ir1+mcolr
      r(ir1)=s7
      ir1=ir1+mcolr
      r(ir1)=s8
      ir1=ir1+mcolr
      r(ir1)=s9
      ir1=ir1+mcolr
      r(ir1)=s10
      ir1=ir1+mcolr
      r(ir1)=s11
      ir1=ir1+mcolr
      r(ir1)=s12
      ir1=ir1+mcolr
      r(ir1)=s13
      ir1=ir1+mcolr
      r(ir1)=s14
      ir1=ir1+mcolr
      r(ir1)=s15
      ir1=ir1+mcolr
      r(ir1)=s16
      ir1=ir1+mcolr
200   ia1=ia1+16
c
      ncolr=mod(ncol,i16)
      if(ncolr.eq.0) return
      ib1=1
      goto (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),ncolr
      write(6,*) 'error mxma: ncol=',ncol,'  ncolr=',ncolr
      call fehler
c
1       s1=0.0d0
        do 101 k=1,nlink
        s1=a(ia1)*b(ib1)+s1
        ia1=ia1+mrowa
101     ib1=ib1+mcolb
        r(ir1)=s1
        return
c
2       s1=0.0d0
        s2=0.0d0
        do 20 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        ia1=ia1+mrowa
20      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        return
c
3       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        do 30 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        ia1=ia1+mrowa
30      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        return
c
4       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        do 40 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        ia1=ia1+mrowa
40      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        return
c
5       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        do 50 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        ia1=ia1+mrowa
50      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        return
c
6       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        do 60 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        ia1=ia1+mrowa
60      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        return

7       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        do 70 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        ia1=ia1+mrowa
70      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        return
c
8       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        do 80 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        ia1=ia1+mrowa
80      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        return
c
9       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        do 90 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        ia1=ia1+mrowa
90      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        return
c
10      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        do 100 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        ia1=ia1+mrowa
100     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        return
c
11      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        do 110 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        ia1=ia1+mrowa
110     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        return
c
12      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        do 120 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        ia1=ia1+mrowa
120     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        return
c
13      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        do 130 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        ia1=ia1+mrowa
130     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        return
c
14      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        do 140 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+1
        s14=a(iaa)*b(ib1)+s14
        ia1=ia1+mrowa
140     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        ir1=ir1+mcolr
        r(ir1)=s14
        return
c
15      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        s15=0.0d0
        do 150 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+1
        s14=a(iaa)*b(ib1)+s14
        iaa=iaa+1
        s15=a(iaa)*b(ib1)+s15
        ia1=ia1+mrowa
150     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        ir1=ir1+mcolr
        r(ir1)=s14
        ir1=ir1+mcolr
        r(ir1)=s15
        return
      end
c--------------------------------------------------------------------
      subroutine mxvax_(a,mcola,mrowa,b,mcolb,
     1                r,mcolr,ncol,nlink)
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      parameter (i16=16)
      dimension r(1),a(1),b(1)
c...  r(ncol)=a(ncol,nlink)*b(nlink) matrix x vector mult
      if(ncol.eq.0) return
      ia1=1
      ir1=1
      do 200 i=1,ncol-15,16
      iaa=ia1
      ibb=1
      s1=0.0d0
      s2=0.0d0
      s3=0.0d0
      s4=0.0d0
      s5=0.0d0
      s6=0.0d0
      s7=0.0d0
      s8=0.0d0
      s9=0.0d0
      s10=0.0d0
      s11=0.0d0
      s12=0.0d0
      s13=0.0d0
      s14=0.0d0
      s15=0.0d0
      s16=0.0d0
      do 160 k=1,nlink
      iaaa=iaa
      s1=s1+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s2=s2+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s3=s3+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s4=s4+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s5=s5+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s6=s6+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s7=s7+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s8=s8+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s9=s9+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s10=s10+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s11=s11+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s12=s12+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s13=s13+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s14=s14+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s15=s15+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s16=s16+a(iaaa)*b(ibb)
      iaa=iaa+mrowa
160   ibb=ibb+mcolb
      r(ir1)=s1
      ir1=ir1+mcolr
      r(ir1)=s2
      ir1=ir1+mcolr
      r(ir1)=s3
      ir1=ir1+mcolr
      r(ir1)=s4
      ir1=ir1+mcolr
      r(ir1)=s5
      ir1=ir1+mcolr
      r(ir1)=s6
      ir1=ir1+mcolr
      r(ir1)=s7
      ir1=ir1+mcolr
      r(ir1)=s8
      ir1=ir1+mcolr
      r(ir1)=s9
      ir1=ir1+mcolr
      r(ir1)=s10
      ir1=ir1+mcolr
      r(ir1)=s11
      ir1=ir1+mcolr
      r(ir1)=s12
      ir1=ir1+mcolr
      r(ir1)=s13
      ir1=ir1+mcolr
      r(ir1)=s14
      ir1=ir1+mcolr
      r(ir1)=s15
      ir1=ir1+mcolr
      r(ir1)=s16
      ir1=ir1+mcolr
200   ia1=ia1+16*mcola
c
      ncolr=mod(ncol,i16)
      if(ncolr.eq.0) return
      ib1=1
      goto (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),ncolr
      call error('case error','mxva')
c
1       s1=0.0d0
        do 101 k=1,nlink
        s1=a(ia1)*b(ib1)+s1
        ia1=ia1+mrowa
101     ib1=ib1+mcolb
        r(ir1)=s1
        return
c
2       s1=0.0d0
        s2=0.0d0
        do 20 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        ia1=ia1+mrowa
20      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        return
c
3       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        do 30 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        ia1=ia1+mrowa
30      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        return
c
4       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        do 40 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        ia1=ia1+mrowa
40      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        return
c
5       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        do 50 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        ia1=ia1+mrowa
50      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        return
c
6       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        do 60 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        ia1=ia1+mrowa
60      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        return

7       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        do 70 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        ia1=ia1+mrowa
70      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        return
c
8       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        do 80 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        ia1=ia1+mrowa
80      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        return
c
9       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        do 90 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        ia1=ia1+mrowa
90      ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        return
c
10      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        do 100 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        ia1=ia1+mrowa
100     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        return
c
11      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        do 110 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        ia1=ia1+mrowa
110     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        return
c
12      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        do 120 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        ia1=ia1+mrowa
120     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        return
c
13      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        do 130 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        ia1=ia1+mrowa
130     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        return
c
14      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        do 140 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+mcola
        s14=a(iaa)*b(ib1)+s14
        ia1=ia1+mrowa
140     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        ir1=ir1+mcolr
        r(ir1)=s14
        return
c
15      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        s15=0.0d0
        do 150 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+mcola
        s14=a(iaa)*b(ib1)+s14
        iaa=iaa+mcola
        s15=a(iaa)*b(ib1)+s15
        ia1=ia1+mrowa
150     ib1=ib1+mcolb
        r(ir1)=s1
        ir1=ir1+mcolr
        r(ir1)=s2
        ir1=ir1+mcolr
        r(ir1)=s3
        ir1=ir1+mcolr
        r(ir1)=s4
        ir1=ir1+mcolr
        r(ir1)=s5
        ir1=ir1+mcolr
        r(ir1)=s6
        ir1=ir1+mcolr
        r(ir1)=s7
        ir1=ir1+mcolr
        r(ir1)=s8
        ir1=ir1+mcolr
        r(ir1)=s9
        ir1=ir1+mcolr
        r(ir1)=s10
        ir1=ir1+mcolr
        r(ir1)=s11
        ir1=ir1+mcolr
        r(ir1)=s12
        ir1=ir1+mcolr
        r(ir1)=s13
        ir1=ir1+mcolr
        r(ir1)=s14
        ir1=ir1+mcolr
        r(ir1)=s15
        return
c
      end
!> MXVB: matrix-vector product
!>
!> calculates the \f${\tt ncol}\times{\tt nrow}\f$ matrix product
!> \f$\bf r = r + A b\f$.
!> Parameters are exactly as for \c mxva; the only difference is that
!>       \c r is not cleared to zero at the start, but the matrix
!>       product is added to the previous contents of \c r.
c--------------------------------------------------------------------
      subroutine mxvb(a,mcola_,mrowa_,b,mcolb_,
     1                r,mcolr_,ncol_,nlink_)
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      integer mcola_,mrowa_,mcolb_,mcolr_,ncol_,nlink_
    !  include "common/clseg"
      parameter (i16=16)
      dimension r(1),a(1),b(1)
c...  r(ncol)=a(ncol,nlink)*b(nlink) matrix x vector mult
      if(ncol_.eq.0) return
      ncol=ncol_
      nlink=nlink_
      mcola=mcola_
      mrowa=mrowa_
      mcolb=mcolb_
      mcolr=mcolr_
#ifdef MOLPRO_BLAS
      if(noblas.eq.0.and.ncol.ge.mindgv.and.nlink.ge.mindgv) then
        if(mcola.eq.1.and.mrowa.ge.ncol) then
          call dgemv_x('N',ncol,nlink,1.0d0,a,mrowa,b,mcolb,1.0d0,
     >         r,mcolr)
          return
        else if(mrowa.eq.1.and.mcola.ge.ncol) then
          call dgemv_x('T',nlink,ncol,1.0d0,a,mcola,b,mcolb,1.0d0,
     >         r,mcolr)
          return
        end if
      end if
#endif
      if(mcola.ne.1) then
         call mxvbx(a,mcola,mrowa,b,mcolb,
     1               r,mcolr,ncol,nlink)
         return
      end if
      ia1=1
      ir1=1
      do 200 i=1,ncol-15,16
      iaa=ia1
      ibb=1
      s1=0.0d0
      s2=0.0d0
      s3=0.0d0
      s4=0.0d0
      s5=0.0d0
      s6=0.0d0
      s7=0.0d0
      s8=0.0d0
      s9=0.0d0
      s10=0.0d0
      s11=0.0d0
      s12=0.0d0
      s13=0.0d0
      s14=0.0d0
      s15=0.0d0
      s16=0.0d0
      do 160 k=1,nlink
      iaaa=iaa
      s1=s1+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s2=s2+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s3=s3+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s4=s4+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s5=s5+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s6=s6+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s7=s7+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s8=s8+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s9=s9+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s10=s10+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s11=s11+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s12=s12+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s13=s13+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s14=s14+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s15=s15+a(iaaa)*b(ibb)
      iaaa=iaaa+1
      s16=s16+a(iaaa)*b(ibb)
      iaa=iaa+mrowa
160   ibb=ibb+mcolb
      r(ir1)=r(ir1)+s1
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s2
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s3
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s4
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s5
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s6
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s7
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s8
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s9
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s10
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s11
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s12
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s13
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s14
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s15
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s16
      ir1=ir1+mcolr
200   ia1=ia1+16
c
      ncolr=mod(ncol,i16)
      if(ncolr.eq.0) return
      ib1=1
      goto (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),ncolr
      call error('case error','mxva')
c
1       s1=0.0d0
        do 101 k=1,nlink
        s1=a(ia1)*b(ib1)+s1
        ia1=ia1+mrowa
101     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        return
c
2       s1=0.0d0
        s2=0.0d0
        do 20 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        ia1=ia1+mrowa
20      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        return
c
3       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        do 30 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        ia1=ia1+mrowa
30      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        return
c
4       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        do 40 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        ia1=ia1+mrowa
40      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        return
c
5       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        do 50 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        ia1=ia1+mrowa
50      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        return
c
6       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        do 60 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        ia1=ia1+mrowa
60      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        return

7       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        do 70 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        ia1=ia1+mrowa
70      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        return
c
8       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        do 80 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        ia1=ia1+mrowa
80      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        return
c
9       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        do 90 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        ia1=ia1+mrowa
90      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        return
c
10      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        do 100 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        ia1=ia1+mrowa
100     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        return
c
11      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        do 110 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        ia1=ia1+mrowa
110     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        return
c
12      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        do 120 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        ia1=ia1+mrowa
120     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        return
c
13      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        do 130 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        ia1=ia1+mrowa
130     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        return
c
14      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        do 140 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+1
        s14=a(iaa)*b(ib1)+s14
        ia1=ia1+mrowa
140     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s14
        return
c
15      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        s15=0.0d0
        do 150 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+1
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+1
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+1
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+1
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+1
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+1
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+1
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+1
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+1
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+1
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+1
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+1
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+1
        s14=a(iaa)*b(ib1)+s14
        iaa=iaa+1
        s15=a(iaa)*b(ib1)+s15
        ia1=ia1+mrowa
150     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s14
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s15
        return
      end
c--------------------------------------------------------------------
      subroutine mxvbx(a,mcola,mrowa,b,mcolb,
     1                r,mcolr,ncol,nlink)
c--------------------------------------------------------------------
      implicit double precision (a-h,o-z)
      parameter (i16=16)
      dimension r(1),a(1),b(1)
c...  r(ncol)=a(ncol,nlink)*b(nlink) matrix x vector mult
      if(ncol.eq.0) return
      ia1=1
      ir1=1
      do 200 i=1,ncol-15,16
      iaa=ia1
      ibb=1
      s1=0.0d0
      s2=0.0d0
      s3=0.0d0
      s4=0.0d0
      s5=0.0d0
      s6=0.0d0
      s7=0.0d0
      s8=0.0d0
      s9=0.0d0
      s10=0.0d0
      s11=0.0d0
      s12=0.0d0
      s13=0.0d0
      s14=0.0d0
      s15=0.0d0
      s16=0.0d0
      do 160 k=1,nlink
      iaaa=iaa
      s1=s1+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s2=s2+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s3=s3+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s4=s4+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s5=s5+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s6=s6+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s7=s7+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s8=s8+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s9=s9+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s10=s10+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s11=s11+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s12=s12+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s13=s13+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s14=s14+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s15=s15+a(iaaa)*b(ibb)
      iaaa=iaaa+mcola
      s16=s16+a(iaaa)*b(ibb)
      iaa=iaa+mrowa
160   ibb=ibb+mcolb
      r(ir1)=r(ir1)+s1
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s2
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s3
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s4
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s5
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s6
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s7
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s8
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s9
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s10
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s11
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s12
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s13
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s14
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s15
      ir1=ir1+mcolr
      r(ir1)=r(ir1)+s16
      ir1=ir1+mcolr
200   ia1=ia1+16*mcola
c
      ncolr=mod(ncol,i16)
      if(ncolr.eq.0) return
      ib1=1
      goto (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),ncolr
      call error('case error','mxva')
c
1       s1=0.0d0
        do 101 k=1,nlink
        s1=a(ia1)*b(ib1)+s1
        ia1=ia1+mrowa
101     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        return
c
2       s1=0.0d0
        s2=0.0d0
        do 20 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        ia1=ia1+mrowa
20      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        return
c
3       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        do 30 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        ia1=ia1+mrowa
30      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        return
c
4       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        do 40 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        ia1=ia1+mrowa
40      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        return
c
5       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        do 50 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        ia1=ia1+mrowa
50      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        return
c
6       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        do 60 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        ia1=ia1+mrowa
60      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        return

7       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        do 70 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        ia1=ia1+mrowa
70      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        return
c
8       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        do 80 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        ia1=ia1+mrowa
80      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        return
c
9       s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        do 90 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        ia1=ia1+mrowa
90      ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        return
c
10      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        do 100 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        ia1=ia1+mrowa
100     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        return
c
11      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        do 110 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        ia1=ia1+mrowa
110     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        return
c
12      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        do 120 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        ia1=ia1+mrowa
120     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        return
c
13      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        do 130 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        ia1=ia1+mrowa
130     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        return
c
14      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        do 140 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+mcola
        s14=a(iaa)*b(ib1)+s14
        ia1=ia1+mrowa
140     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s14
        return
c
15      s1=0.0d0
        s2=0.0d0
        s3=0.0d0
        s4=0.0d0
        s5=0.0d0
        s6=0.0d0
        s7=0.0d0
        s8=0.0d0
        s9=0.0d0
        s10=0.0d0
        s11=0.0d0
        s12=0.0d0
        s13=0.0d0
        s14=0.0d0
        s15=0.0d0
        do 150 k=1,nlink
        iaa=ia1
        s1=a(iaa)*b(ib1)+s1
        iaa=iaa+mcola
        s2=a(iaa)*b(ib1)+s2
        iaa=iaa+mcola
        s3=a(iaa)*b(ib1)+s3
        iaa=iaa+mcola
        s4=a(iaa)*b(ib1)+s4
        iaa=iaa+mcola
        s5=a(iaa)*b(ib1)+s5
        iaa=iaa+mcola
        s6=a(iaa)*b(ib1)+s6
        iaa=iaa+mcola
        s7=a(iaa)*b(ib1)+s7
        iaa=iaa+mcola
        s8=a(iaa)*b(ib1)+s8
        iaa=iaa+mcola
        s9=a(iaa)*b(ib1)+s9
        iaa=iaa+mcola
        s10=a(iaa)*b(ib1)+s10
        iaa=iaa+mcola
        s11=a(iaa)*b(ib1)+s11
        iaa=iaa+mcola
        s12=a(iaa)*b(ib1)+s12
        iaa=iaa+mcola
        s13=a(iaa)*b(ib1)+s13
        iaa=iaa+mcola
        s14=a(iaa)*b(ib1)+s14
        iaa=iaa+mcola
        s15=a(iaa)*b(ib1)+s15
        ia1=ia1+mrowa
150     ib1=ib1+mcolb
        r(ir1)=r(ir1)+s1
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s2
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s3
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s4
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s5
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s6
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s7
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s8
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s9
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s10
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s11
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s12
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s13
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s14
        ir1=ir1+mcolr
        r(ir1)=r(ir1)+s15
        return
c
      end

#endif
